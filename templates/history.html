<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Detection History ‚Äì ANPR Vision</title>
    <meta name="description"
        content="View all past number plate detections with timestamps, confidence scores, and output images." />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

    <!-- ===== NAVBAR ===== -->
    <nav class="navbar">
        <div class="nav-brand">
            <div class="nav-logo">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                    <rect width="28" height="28" rx="8" fill="url(#grad2)" />
                    <path d="M5 10h18M5 14h18M5 18h18" stroke="white" stroke-width="2" stroke-linecap="round" />
                    <defs>
                        <linearGradient id="grad2" x1="0" y1="0" x2="28" y2="28">
                            <stop stop-color="#6366f1" />
                            <stop offset="1" stop-color="#8b5cf6" />
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <div>
                <span class="nav-title">ANPR<span class="nav-accent"> Vision</span></span>
                <span class="nav-subtitle">Plate Recognition AI</span>
            </div>
        </div>
        <div class="nav-links">
            <a href="/" class="nav-link" id="nav-detect">üîç Detect</a>
            <a href="/history" class="nav-link active" id="nav-history">üìã History</a>
        </div>
        <div class="nav-status">
            <span class="status-dot pulse"></span>
            <span class="status-text">Model Active</span>
        </div>
    </nav>

    <!-- ===== HERO ===== -->
    <section class="hero hero-sm">
        <div class="hero-bg-orb orb1"></div>
        <div class="hero-bg-orb orb2"></div>
        <div class="hero-content">
            <div class="hero-badge">
                <span class="badge-icon">üìã</span>
                <span>Scan Records</span>
            </div>
            <h1 class="hero-title">Detection <span class="gradient-text">History</span></h1>
            <p class="hero-subtitle">Browse all past number plate scans with results and metadata.</p>
        </div>
    </section>

    <!-- ===== MAIN ===== -->
    <main class="main-container">

        <!-- Controls Bar -->
        <div class="hist-controls">
            <div class="search-wrap">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" class="search-input" placeholder="Search plate number..." />
            </div>
            <div class="hist-meta">
                <span class="hist-count" id="histCount">0 Records</span>
                <button class="refresh-btn" id="refreshBtn">‚Üª Refresh</button>
            </div>
        </div>

        <!-- Stats Row -->
        <div class="stats-row" id="statsRow">
            <div class="stat-card">
                <div class="stat-num" id="statTotal">‚Äî</div>
                <div class="stat-lbl">Total Scans</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="statAvgConf">‚Äî</div>
                <div class="stat-lbl">Avg. Confidence</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="statToday">‚Äî</div>
                <div class="stat-lbl">Today's Scans</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="statUnique">‚Äî</div>
                <div class="stat-lbl">Unique Plates</div>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading-wrap" id="loadingWrap">
            <div class="loading-spinner"></div>
            <p>Fetching records‚Ä¶</p>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display:none;">
            <div class="empty-icon">üìÇ</div>
            <h3>No Records Yet</h3>
            <p>Upload a vehicle image or video on the Detect page to get started.</p>
            <a href="/" class="detect-btn" style="display:inline-flex;margin-top:16px;">üîç Go to Detect</a>
        </div>

        <!-- History Grid -->
        <div class="history-grid" id="historyGrid" style="display:none;"></div>

    </main>

    <!-- ===== IMAGE MODAL ===== -->
    <div class="modal-overlay" id="modalOverlay" style="display:none;">
        <div class="modal-box">
            <button class="modal-close" id="modalClose">‚úï</button>
            <img id="modalImg" src="" alt="Output" class="modal-img" />
            <div class="modal-info" id="modalInfo"></div>
        </div>
    </div>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
        <p>ANPR Vision &copy; 2025 ¬∑ Built with YOLOv8 + EasyOCR ¬∑ <a href="/">New Detection</a></p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // History page specific init
        window.addEventListener('DOMContentLoaded', () => {
            window.ANPR_PAGE = 'history';
            initHistory();
        });
    </script>
</body>

</html>